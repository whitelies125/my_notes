# 312 CSMA 协议

介质访问控制—动态划分信道—随机访问介质控制—CSMA 协议。

**载波监听多路访问协议（CSMA，Carrier Sense Multiple Access）**

CS：载波监听，每一个站在**发送数据前**要检测一下总线上是否有其他计算机在发送数据。

小知识，如何判断是否有其他计算机在发送数据：
当几个站同时在总线上发送数据时，总线上的信号**电压摆动值**将会增大（叠加）。当一个站检测到的信号电压摆动值超过一定门限值时，就认为总线上至少有两个站同时在发送数据，表明发生了碰撞，即发生了冲突。

MA：多点接入，表示许多计算机以多点接入的方式连接在一根总线上。

CSMA 协议的思想：在发送帧前，监听信道。

监听结果，信道空闲，则发送完整帧；信道忙，则推迟发送。

对于是否立刻发送完整帧，以及推迟多久的问题，就有了一下三种协议：

1. 1-坚持 CSMA
2. 非坚持 CSMA
3. p-坚持 CSMA

## 一. 1-坚持 CSMA

坚持指的是对于监听信道**忙**之后的坚持。

1-坚持 CSMA 思想：
如果一个主机要发送消息，那么它先监听信道。
若信道空闲，则直接传输，不等待。
若信道忙，则持续监听，直到信道空闲，马上传输。

如果有冲突（一段时间内未收到确认），则等待一个随机长的时间再监听重复上述过程。

优点：只要媒体空闲，站点就马上发送，避免了媒体利用率的损失。
缺点：如果有两个或以上的站点有数据要发送，当信道由忙变空闲，则其冲突不可避免。

## 二. 非坚持 CSMA

非检查指对于监听信道**忙**之后就不继续监听

非坚持 CSMA 思想：
如果一个主机要发送消息，那么它先监听信道。
若信道空闲，则直接传输，不等待。
若信道忙，则等待一个随机的时间后，再进行监听。

优点：采用随机的重发延迟时间可减少冲突发送的可能性。
缺点：可能存在大家都在延迟等待过程中，但该媒体处于空闲状态，使得媒体利用率低。

## 三. p-坚持 CSMA

p-检查指指得是对于监听信道**空闲**的处理。

p-坚持 CSMA 采用的是时分信道，也就是将时间分为了一段一段的时隙（时间片、时间槽）。

p-坚持 CSMA 思想：
如果一个主机要发送消息，那么它先监听信道。
若信道空闲，则以概率 p 直接传输，不等待，以概率 1-p 推迟到下一个时隙；如果推迟到下一时隙，再次监听信道空闲，仍概率 p 直接传输，以概率 1-p 等待到下一个时隙......以此重复，直到传输出去或信道忙。
若信道忙，则持续监听，即等到下一个时隙重新监听，直到信道空闲。

（王道<计网>视频中说，概率 p 不是考研考点，只需要知道是人为设置的一个值就可以了。）

优点：既能像非坚持算法那样减少冲突，又能像 1-坚持算法那样减少媒体空闲时间。

当发生冲突时，p-坚持 CSMA 还是会将数据帧发送完，造成浪费。
（我觉得，这个是 CSMA 都有的缺点，毕竟判断发生冲突是没收到确认，CSMA 都会发送出去。）

2021.01.31